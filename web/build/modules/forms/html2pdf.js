function ParseContainer(a,b,c,d){var e=[],f=b.childNodes;if(0!=f.length)for(var g=0;g<f.length;g++)c=ParseElement(e,f[g],c,d);if(0!=e.length)for(var g=0;g<e.length;g++)a.push(e[g]);return c}function ComputeStyle(a,b){for(var c=0;c<b.length;c++){var d=b[c].trim().toLowerCase().split(":");if(2==d.length)switch(d[0]){case"font-size":a.fontSize=parseInt(d[1]);break;case"text-align":switch(d[1]){case"right":a.alignment="right";break;case"center":a.alignment="center"}break;case"font-weight":switch(d[1]){case"bold":a.bold=!0}break;case"text-decoration":switch(d[1]){case"underline":a.decoration="underline"}break;case"font-style":switch(d[1]){case"italic":a.italics=!0}}}}function ParseElement(a,b,c,d){if(d||(d=[]),b.getAttribute){var e=b.getAttribute("style");if(e)for(var f=e.split(";"),g=0;g<f.length;g++)d.push(f[g])}switch(b.nodeName.toLowerCase()){case"#text":var h={text:b.textContent.replace(/\n/g,"")};d&&ComputeStyle(h,d),c.text.push(h);break;case"b":case"strong":ParseContainer(a,b,c,d.concat(["font-weight:bold"]));break;case"u":ParseContainer(a,b,c,d.concat(["text-decoration:underline"]));break;case"i":ParseContainer(a,b,c,d.concat(["font-style:italic"]));break;case"span":ParseContainer(a,b,c,d);break;case"br":c=CreateParagraph(),a.push(c);break;case"table":var h={table:{widths:[],body:[]}},i=b.getAttribute("border"),j=!1;i&&1==parseInt(i)&&(j=!0),j||(h.layout="noBorders"),ParseContainer(h.table.body,b,c,d);var k=b.getAttribute("widths");if(k)for(var l=k.split(","),g=0;g<l.length;g++)h.table.widths.push(l[g]);else if(0!=h.table.body.length&&0!=h.table.body[0].length)for(var g=0;g<h.table.body[0].length;g++)h.table.widths.push("*");a.push(h);break;case"tbody":ParseContainer(a,b,c,d);break;case"tr":var m=[];ParseContainer(m,b,c,d),a.push(m);break;case"td":c=CreateParagraph();var n={stack:[]};n.stack.push(c);var o=b.getAttribute("rowspan");o&&(n.rowSpan=parseInt(o));var p=b.getAttribute("colspan");p&&(n.colSpan=parseInt(p)),ParseContainer(n.stack,b,c,d),a.push(n);break;case"div":case"p":c=CreateParagraph();var n={stack:[]};n.stack.push(c),ComputeStyle(n,d),ParseContainer(n.stack,b,c),a.push(n);break;default:console.log("Parsing for node "+b.nodeName+" not found")}return c}function ParseHtml(a,b){for(var c=$(b.replace(/\t/g,"").replace(/\n/g,"")),d=CreateParagraph(),e=0;e<c.length;e++)ParseElement(a,c.get(e),d)}function CreateParagraph(){var a={text:[]};return a}